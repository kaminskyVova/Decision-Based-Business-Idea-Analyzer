
# Clarification Layer — Спецификация

## 1. Назначение

Clarification Layer является частью модуля Gatekeeper и предназначен для формализованного запроса недостающих или некорректных данных, необходимых для принятия решения о допуске бизнес-идеи к анализу.

Clarification Layer:
- не выполняет анализ;
- не предлагает решений;
- не изменяет критерии допуска;
- не расширяет исходный scope запроса.

Задача слоя — обеспечить корректный и ограниченный возврат данных в Gatekeeper.

---

## 2. Точка активации

Clarification Layer активируется **исключительно** при результате Gatekeeper `RETURN WITH CONDITIONS`.

Активация слоя невозможна при:
- `HARD FAIL`;
- `ADMITTED`.

---

## 3. Входные данные

На вход Clarification Layer поступают:

- текущие структурированные входные данные;
- список применённых reason codes, приведших к `RETURN WITH CONDITIONS`;
- идентификатор этапа Decision Pipeline, на котором возникла нехватка данных.

Clarification Layer **не получает** доступ к аналитическим модулям и результатам анализа.

---

## 4. Типы оснований для запроса уточнений

Clarification Layer формирует запросы уточнений **только** по следующим основаниям:

1. Отсутствие обязательных данных  
   (не заполнено или не указано критическое поле).

2. Некорректные данные  
   (формально указаны, но не соответствуют допустимым рамкам или формату).

3. Логические противоречия  
   (данные присутствуют, но взаимно исключают друг друга).

Любые иные основания для запроса уточнений недопустимы.

---

## 5. Правила формирования запросов

Запросы Clarification Layer подчиняются следующим правилам:

- каждый запрос касается **только одного недостающего или некорректного параметра**;
- вопросы формулируются однозначно и без альтернатив;
- запрос не содержит рекомендаций, оценок или предположений;
- Clarification Layer не предлагает вариантов ответа.

Clarification Layer не допускает повторного запроса одного и того же параметра без изменения входных данных.
После сбора данных управление всегда возвращается в Gatekeeper.

---

 ## 6. Ограничения слоя 

Clarification Layer строго ограничен следующими рамками:

- не анализирует ответы пользователя;
- не интерпретирует намерения;
- не смягчает критерии Gatekeeper;
- не заменяет отсутствующие данные предположениями;
- не инициирует новые проверки.

Слой не имеет права принимать итоговые решения.

---

## 7. Выходы и возврат управления

Clarification Layer имеет **только два возможных выхода**:

1. Возврат управления в Gatekeeper  
   — при предоставлении пользователем запрошенных данных.

2. Эскалация в `HARD FAIL`  
   — при отказе пользователя предоставить данные;
   — при уклонении от ответа;
   — при повторной подаче некорректных данных.

В обоих случаях Clarification Layer не формирует самостоятельный итог.

---

## 8. Ошибки и эскалация

Основаниями для немедленной эскалации в `HARD FAIL` являются:

- попытка изменить исходную цель вместо уточнения данных;
- попытка расширить scope запроса;
- попытка переложить ответственность на систему;
- повторные запросы без внесения изменений;
- попытка запутать систему вместо внесения данных;
- умышленное искажение входных данных.

Соответствующие reason codes фиксируются на уровне Gatekeeper.

---

## 9. Границы ответственности

Clarification Layer:
- занимается только сбором недостающей информации;
- не взаимодействует с модулем Analysis;
- не влияет на типы Decision Outcomes;
- не хранит состояние между сессиями.

---

## 10. Статус документа

Версия: v1.0 

